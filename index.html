<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Calendario Financiero</title>
    <!-- MANIFEST PARA PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">

    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>ğŸ“Š Finanzas Personales</h1>

<!-- BotÃ³n de menÃº superior izquierda -->
<button id="menuBtn">ğŸ </button>

<!-- Sidebar lateral -->
<div id="sidebar" class="sidebar">
    <button class="tab-btn active" data-tab="calendarTab">ğŸ“… Calendario</button>
    <button class="tab-btn" data-tab="budgetTab">ğŸ’° Presupuesto</button>
    <button class="tab-btn" data-tab="addTab">â• Agregar Movimiento</button>
    <button class="tab-btn" data-tab="viewTab">ğŸ“ Movimientos</button>
    <button class="tab-btn" data-tab="cardsTab">ğŸ’³ Tarjetas</button>
</div>

<!-- ======================== CALENDARIO ======================== -->
<div id="calendarTab" class="tab-content active">
    <div id="calendar"></div>
</div>

<!-- ======================== PRESUPUESTO ======================== -->
<div id="budgetTab" class="tab-content">
    <div class="small-box">
        <h3>ğŸ’° Presupuesto del mes</h3>
        <form id="budgetForm">
            <div class="form-group">
               <p id="mesActual"></p>
               <label for="saldoTotal">Dinero disponible hoy</label>
               <input type="number" id="saldoTotal" placeholder="Cantidad">
            </div>

            <div class="form-group">
               <label for="inputFechaInicio">Fecha inicio</label>
               <input type="date" id="inputFechaInicio">
            </div>

            <button type="submit" id="saldoBtn">Guardar</button>
            <p id="fechaMonto" style="margin-top:15px; font-weight: 600; display:none;">
                A partir del: <span id="fechaMontoValor"></span>
            </p>
            <p id="gastoDiario"></p>
        </form>      
    </div>
</div>

<!-- ======================== AGREGAR MOVIMIENTO ======================== -->
<div id="addTab" class="tab-content">
    <div class="small-box">
        <h3>â• Agregar Movimiento</h3>
        <form id="entryForm">
            <div class="form-group">
                <label for="date">Fecha:</label>
                <input type="date" id="date" required>
            </div>
            <div class="form-group">
                <label for="amount">Cantidad:</label>
                <input type="number" id="amount" placeholder="Cantidad" required>
            </div>
            <div class="form-group">
                <label for="type">Tipo:</label>
                <select id="type">
                    <option value="gasto">Gasto</option>
                    <option value="ingreso">Ingreso</option>
                </select>
            </div>
            <div class="form-group">
                <label for="category">CategorÃ­a:</label>
                <input type="text" id="category" placeholder="CategorÃ­a">
            </div>
            <div class="form-group">
                <label for="payment">MÃ©todo de Pago:</label>
                <select id="payment">
                    <option value="Efectivo">Efectivo</option>
                    <option value="Tarjeta">Tarjeta</option>
                </select>
            </div>

            <div id="mesesContainer" style="display:none; margin-top:10px;">
                <label>Â¿Es a meses?</label>
                <select id="esMeses">
                    <option value="no">No</option>
                    <option value="si">SÃ­</option>
                </select>

                <div id="detalleMeses" style="display:none; margin-top:10px;">
                    <input type="number" id="meses" placeholder="NÃºmero de meses">
                    <input type="number" id="mensualidad" placeholder="Mensualidad calculada (editable)">
                    <p id="ultimoPago"></p>
                </div>
            </div>

            <button type="submit">Guardar</button>
        </form>
    </div>
</div>

<!-- ======================== MOVIMIENTOS ======================== -->
<div id="viewTab" class="tab-content">
    <ul id="entryList"></ul>

    <div id="dashboard">
        <h2 id="resumenMes">ğŸ“Š Resumen del Mes</h2>
        <p id="totalIngresos">Ingresos: $0</p>
        <p id="totalGastos">Gastos: $0</p>
        <p id="saldoRestante">Saldo restante: $0</p>

        <div id="progressBarContainer">
            <div id="progressBar"></div>
        </div>
    </div>
</div>

<!-- ======================== TARJETAS ======================== -->
<div id="cardsTab" class="tab-content">
    <form id="cardForm" style="margin-bottom: 20px;">
        <input type="text" id="cardName" placeholder="Nombre de la tarjeta" required>
        <input type="number" id="cardLimit" placeholder="Monto mÃ¡ximo" required>
        <label>Fecha de corte:</label>
        <input type="date" id="cutDate" required>
        <label>Fecha de pago:</label>
        <input type="date" id="paymentDate" required>
        <button type="submit">Agregar Tarjeta</button>
    </form>

    <div id="cardsListContainer">
        <label for="cardsList">Tarjetas agregadas:</label>
        <select id="cardsList"></select>
    </div>
</div>

<!-- ======================== SCRIPTS ======================== -->
<!-- Tu archivo principal con todas las funciones (movimientos, calendario, tarjetas, IndexedDB) -->
<script type="module" src="main.js"></script>

<!-- Script para mostrar mes actual en presupuesto -->
<script>
    const mesNombres = [
        "Enero","Febrero","Marzo","Abril","Mayo","Junio",
        "Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"
    ];
    const hoy = new Date();
    document.getElementById("mesActual").textContent =
        mesNombres[hoy.getMonth()] + " " + hoy.getFullYear();
</script>

<!-- Service Worker -->
<script>
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
            navigator.serviceWorker.getRegistrations().then(regs => {
    for(let reg of regs) reg.unregister();
});

        });
    }
</script>

</body>
</html>
